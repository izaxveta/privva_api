# Privva API

The Privva API is an interface that allows you to query meta-data for User and Issue models. Below is documentation on how to install, test, interact with and query the interface.

## Getting Started

### Prerequisites

This project requires Ruby 2.3.1+ and Rails 5.1.6+

### Installing
To interact with this API locally, clone down this repository into your local machine by running the following command in your machine's terminal:
```
git clone https://github.com/izaxveta/privva_api.git
```

Navigate into the cloned directory and run `bundle` in the terminal to download required Ruby gems and relevant dependencies.

### Setting up the Database

To setup the database environment and run migration files:

```
rails db:create db:migrate
```

This repository contains sample seed data that can be used for the development environment. To utilize this set in the development database, run `rails db:seed` after migrating.

## Running the tests

This API is backed by a test suite that is built using RSpec. These tests can be run by using `rspec` in the terminal while in the project directory.

Running the test suite will also create a code coverage report with SimpleCov. Use `open coverage/index.html` in the terminal to view these reports in your browser.

## Interacting with the API

To interact with this API locally, simply start the server by running `rails s` and visiting `localhost:3000` in your browser.

Note: Running `rails s` starts the server using the "development" environment by default. To use a different environment, specify by appending it to the end of the command (i.e. `rails s test` or `rails s production`).

### Interacting with the Database

Interacting with the database directly can be done by running `rails c` in the terminal to access the database console. Specifying which database environment to be used can be done here be appending the environment name after the command, as seen in the example described in Interacting with the API. This console is where model objects can be created, deleted and manipulated.

### Models

Model specs are described below.

**USER Model**

| Attribute | Description |
| --- | --- |
| `:id` | [ Integer ] Object unique identifier. Autogenerated on save. |
| `:name` | [ String ] *Required* |
| `:email` | [ String ] Unique across all Users. Validates values conforms to proper email format. *Required*  |

**ISSUE Model**

| Attribute | Description |
| --- | --- |
| `:id` | [ Integer ] Object unique identifier. Autogenerated on save. |
| `:status` | [ Integer ] Integer points to indexed enum value. Enum values are one of `CREATED`(0), `OPEN`(1), `CLOSED`(2), and `ARCHIVED`(3). *Required*  |
| `:summary` | [ String ] Description of issue reported. *Required* |
| `:reporter_id` | [ Integer ] Reference to user who issued the issue. Accepted integer value points to the :id of the issuing user. *Required* |
| `:assignee_id` | [ Integer ] Reference to user the issue is being assigned to. Accepted integer value points to the :id of the assigned user. *Required* |

### Issue Model Requests

An example of an Issue API request created on the local server is as follows:

```
localhost:3000/api/v1/issues
```

Such a request will return JSON of all Issues existing within the specified environment's database. Below are all parameters that can be used to customize a query.

| Query Parameter | Description |
| --- | --- |
| `:issue_summary` | Will return all Issues with summaries that match a given string - Example: `/api/v1/issues?issue_summary=Hello World` |
| `:reporter_name` | Will return all Issues reported by a user whose name matches a given value - Example: `/api/v1/issues?reporter_name=Bill Compton` |
| `:assignee_name` | Will return all Issues assigned to a user whose name matches a given value - Example: `/api/v1/issues?assignee_name=Sookie Stackhouse` |
| `:sort_order` | Will return all Issues sorted by a provided query. Accepted queries include `issue_summary`, `status`,  `created_at` and `updated_at`. Issues will be returned sorted alpabetically or by date and can be reversed by appending `DESC` to the query - Example: `/api/v1/issues?sort_order=created_at DESC` |
| `:page_size` | Will return all Issues paginated and in groups of the provided integer value - Example: `/api/v1/issues?page_size=30` |
| `:page` | When used with `:page_size`, a page to be returned will be specified when using pagination - Example: `/api/v1/issues?page_size=25&&page=3`|


## Built With

* [Active Model Serializers](https://github.com/rails-api/active_model_serializers) - Serializer used to handle attributes to be serialized
* [Will Paginate](https://github.com/mislav/will_paginate) - Paginator
* [API Pagination](https://github.com/davidcelis/api-pagination) - Used to paginate API results
* [Shoulda Matchers](https://github.com/thoughtbot/shoulda-matchers) - Provides one-liners to test Rails functionality
* [Database Cleaner](https://github.com/DatabaseCleaner/database_cleaner) - Used to clean test database environment between runs
* [SimpleCov](https://github.com/colszowka/simplecov) - Provides test coverage reports for codebase

## Author

* [Elizabeth Jimenez](https://github.com/izaxveta/) - *Initial product*